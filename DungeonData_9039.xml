<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<Dungeon continentId="9039" name="@dungeon:9039" startPos="-26296,40119,2345" exitContinentId="7002" exitPos="-7500,48414,3240" exitDir="185" destroyWaitMin="0">
  <!-- 1501 광기의 언덕 마차 수호 퀘스트 -->
  <RestoreTargetQuest id="1507" forceRestore="true"/>
  <Condition type="party" value="1" />
  <Condition type="levelOver" value="22" />
  <Condition type="progressQuest" value="1507" taskId="6" />
  <Condition type="completeQuest" value="1507" /> 
  <EventGroup type="talkNpc" uniqueId="439,1001">
    <Event textId="2" questId="1507" taskId="7">
      <!-- 수호 이벤트 몬스터 스폰 이벤트 -->
      <EventTaskGroup>
        <EventTask type="timerUi" time="120" next="time" nextValue="0" />
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900002" targetNpcId="439,5002" startAggro="0" next="time" nextValue="0" />
        <!-- 호위부대 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900016" targetNpcId="439,5002" startAggro="100" next="time" nextValue="0" />
        <!-- 호위부대 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900017" targetNpcId="439,5002" startAggro="100" next="time" nextValue="0" />
        <!-- 호위부대 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900018" targetNpcId="439,5002" startAggro="100" next="time" nextValue="0" />
        <!-- 호위부대 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900003" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- 대치조(오른쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900004" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- 대치조(정면) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900005" targetNpcId="439,1001" startAggro="100" next="time" nextValue="10" />
        <!-- 대치조(왼쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900006" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave1난폭한 난쟁이(오른쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900007" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave1난폭한 난쟁이(정면) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900008" targetNpcId="439,1001" startAggro="100" next="time" nextValue="20" />
        <!-- wave1난폭한 난쟁이(왼쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900006" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave1-1난폭한 난쟁이(오른쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900007" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave1-1난폭한 난쟁이(정면) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900008" targetNpcId="439,1001" startAggro="100" next="time" nextValue="20" />
        <!-- wave1-1난폭한 난쟁이(왼쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900011" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave2아만,캐스타닉광인(왼쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900009" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave2아만,캐스타닉광인(오른쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900010" targetNpcId="439,1001" startAggro="100" next="time" nextValue="20" />
        <!-- wave2아만,캐스타닉광인(정면) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900011" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave2-1아만,캐스타닉광인(왼쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900009" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave2-1아만,캐스타닉광인(오른쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900010" targetNpcId="439,1001" startAggro="100" next="time" nextValue="20" />
        <!-- wave2-1아만,캐스타닉광인(정면) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900013" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave3 마을경비 소대장(정면) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900014" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave3 마을경비 소대장(왼쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900012" targetNpcId="439,1001" startAggro="100" next="time" nextValue="10" />
        <!-- wave3 마을경비 소대장(오른쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900013" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave3-1 마을경비 소대장(정면) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900014" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave3-1 마을경비 소대장(왼쪽) 테리토리 -->
        <EventTask type="spawn" huntingZoneId="439" territoryId="43900012" targetNpcId="439,1001" startAggro="100" next="time" nextValue="0" />
        <!-- wave3-1 마을경비 소대장(오른쪽) 테리토리 -->
      </EventTaskGroup>
    </Event>
    <Event textId="2" questId="1507" taskId="4">
      <!-- 수호 이벤트 진행 시간을 알려주는 알림 메시지 -->
      <EventTaskGroup>
        <EventTask type="message" string="@dungeon:9039001" style="default" next="time" nextValue="300" />
        <EventTask type="message" string="@dungeon:9039002" style="default" next="time" nextValue="240" />
        <EventTask type="message" string="@dungeon:9039003" style="default" next="time" nextValue="55" />
        <EventTask type="message" string="@dungeon:9039004" style="default" next="none" />
      </EventTaskGroup>
    </Event>
  </EventGroup>
  <EventGroup type="npcHp" uniqueId="439,1001" value="90">
    <!-- 마차의 상태를 알려주는 알림 대사 -->
    <Event>
      <EventTaskGroup>
        <EventTask type="message" string="@dungeon:9039005" targetNpcId="439,43900001" nextValue="90" next="npcHp" />
        <EventTask type="message" string="@dungeon:9039006" targetNpcId="439,43900001" nextValue="50" next="npcHp" />
        <EventTask type="message" string="@dungeon:9039007" targetNpcId="437,43900001" nextValue="45" next="npcHp" />
        <EventTask type="message" string="@dungeon:9039008" targetNpcId="439,43900001" nextValue="30" next="npcHp" />
        <EventTask type="message" string="@dungeon:9039009" targetNpcId="439,43900001" nextValue="10" next="npcHp" />
        <EventTask type="message" string="@dungeon:9039010" targetNpcId="439,43900001" nextValue="0" next="npcHp" />
        <EventTask type="message" string="@dungeon:9039011" style="default" next="none" />
      </EventTaskGroup>
    </Event>
  </EventGroup>
  <EventGroup type="enterTerritory" uniqueId="439,43900015">
    <!-- 유저가 마차에 접근하면 마차와 대화하라고 안내하는 팝업 대사 -->
    <Event>
      <EventTaskGroup>
        <EventTask type="message" string="@dungeon:9039012" targetNpcId="439,1003" next="time" nextValue="5" />
        <EventTask type="message" string="@dungeon:9039013" targetNpcId="439,1003" next="none" />
      </EventTaskGroup>
    </Event>
  </EventGroup>
  <EventGroup type="questFail">
    <!-- 수호 퀘스트 실패 시 처리 -->
    <Event questId="1507" taskId="4">
      <EventTaskGroup>
        <EventTask type="message" string="@dungeon:9039014" style="alert" next="time" nextValue="3" />
        <EventTask type="teleport" continentId="7002" pos="-7409,48400,3221" next="none" />
      </EventTaskGroup>
    </Event>
  </EventGroup>
  <Condition type="maxMemberCount" value="5" />
</Dungeon>